{"version":3,"file":"bundle.js","sources":["loadAndProcessData.js","index.js"],"sourcesContent":["import { feature } from 'topojson';\nimport { tsv, json } from 'd3';\n\nexport const loadAndProcessData = (render =>\n  json('https://cdn.jsdelivr.net/npm/us-atlas@3/states-albers-10m.json')\n    .then((topoJSONdata) => {\n      const states = feature(topoJSONdata, topoJSONdata.objects.states);\n\n      fetch(\"https://api.airtable.com/v0/appIo1lqaLGrB5dLz/Table%201?maxRecords=100&view=Grid%20view\", {\n        headers: new Headers({\n          \"Authorization\": `Bearer keyiUyROsiT6hATuI`\n        })\n      }).then( response => {\n        response.json().then( jailPopPerCap => {\n          const populationData = jailPopPerCap.records.map( (r) => {\n            return {state: r.fields.State, jailPop: r.fields[\"Jail Population per capita\"]}\n          })\n\n          render(states, populationData)\n        })\n      })\n\n    }))","import {\n  select,\n  geoAlbersUsa,\n  geoPath,\n  zoom,\n  mouse,\n  event,\n  scaleQuantize,\n  scaleThreshold,\n  schemeReds,\n  max\n} from 'd3';\nimport { legend } from './legend'\nimport { loadAndProcessData } from './loadAndProcessData';\n// import { colorLegend } from './colorLegend';\n\nconst colorScale = scaleQuantize().domain([1, 500]).range(schemeReds[9])\nconst svg = select('svg');\nconst pathGenerator = geoPath()\nconst g = svg.append('g');\n\nsvg.call(zoom().on('zoom', () => {\n  g.attr('transform', event.transform);\n}));\n\nconst choroplethColor = (d, states, data) => {\n  let stateData = data.filter((r) => r.state == d.properties.name)[0]\n\n  if (stateData) {\n    d.jailPopPerCap = stateData.jailPop\n  }\n\n  return colorScale(d.jailPopPerCap)\n}\n\nconst stateClick = (d) => {\n  console.log('clicked', d)\n}\n\nfunction render(states, jailPopPerCap) {\n  g.selectAll('path').data(states.features)\n  .enter().append('path')\n    .attr('class', 'state')\n    .attr('d', pathGenerator)\n    .attr('fill', (d) => choroplethColor(d, states, jailPopPerCap))\n  .on(\"click\", stateClick)\n}\n\nloadAndProcessData(render)"],"names":["const","json","feature","scaleQuantize","schemeReds","select","geoPath","zoom","event","let"],"mappings":";;;EAGOA,IAAM,kBAAkB,cAAI,iBACjCC,OAAI,CAAC,gEAAgE,CAAC;EACxE,KAAK,IAAI,WAAE,YAAY,EAAK;EAC5B,MAAMD,IAAM,MAAM,GAAGE,gBAAO,CAAC,YAAY,EAAE,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AACxE;EACA,MAAM,KAAK,CAAC,yFAAyF,EAAE;EACvG,QAAQ,OAAO,EAAE,IAAI,OAAO,CAAC;EAC7B,UAAU,eAAe,EAAE,0BAA0B;EACrD,SAAS,CAAC;EACV,OAAO,CAAC,CAAC,IAAI,YAAE,UAAY;EAC3B,QAAQ,QAAQ,CAAC,IAAI,EAAE,CAAC,IAAI,YAAE,eAAiB;EAC/C,UAAUF,IAAM,cAAc,GAAG,aAAa,CAAC,OAAO,CAAC,GAAG,YAAG,CAAC,EAAK;EACnE,YAAY,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC,MAAM,CAAC,4BAA4B,CAAC,CAAC;EAC3F,WAAW,EAAC;AACZ;EACA,UAAU,MAAM,CAAC,MAAM,EAAE,cAAc,EAAC;EACxC,SAAS,EAAC;EACV,OAAO,EAAC;AACR;EACA,KAAK,IAAC;;ECRN;AACA;EACAA,IAAM,UAAU,GAAGG,gBAAa,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,KAAK,CAACC,aAAU,CAAC,CAAC,CAAC,EAAC;EACxEJ,IAAM,GAAG,GAAGK,SAAM,CAAC,KAAK,CAAC,CAAC;EAC1BL,IAAM,aAAa,GAAGM,UAAO,GAAE;EAC/BN,IAAM,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AAC1B;EACA,GAAG,CAAC,IAAI,CAACO,OAAI,EAAE,CAAC,EAAE,CAAC,MAAM,cAAQ;EACjC,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,EAAEC,QAAK,CAAC,SAAS,CAAC,CAAC;EACvC,CAAC,CAAC,CAAC,CAAC;AACJ;EACAR,IAAM,eAAe,aAAI,CAAC,EAAE,MAAM,EAAE,IAAI,EAAK;EAC7C,EAAES,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,WAAE,CAAC,WAAK,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,UAAU,CAAC,OAAI,CAAC,CAAC,CAAC,EAAC;AACrE;EACA,EAAE,IAAI,SAAS,EAAE;EACjB,IAAI,CAAC,CAAC,aAAa,GAAG,SAAS,CAAC,QAAO;EACvC,GAAG;AACH;EACA,EAAE,OAAO,UAAU,CAAC,CAAC,CAAC,aAAa,CAAC;EACpC,EAAC;AACD;EACAT,IAAM,UAAU,aAAI,CAAC,EAAK;EAC1B,EAAE,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,EAAC;EAC3B,EAAC;AACD;EACA,SAAS,MAAM,CAAC,MAAM,EAAE,aAAa,EAAE;EACvC,EAAE,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;EAC3C,GAAG,KAAK,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC;EACzB,KAAK,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC;EAC3B,KAAK,IAAI,CAAC,GAAG,EAAE,aAAa,CAAC;EAC7B,KAAK,IAAI,CAAC,MAAM,YAAG,CAAC,WAAK,eAAe,CAAC,CAAC,EAAE,MAAM,EAAE,aAAa,IAAC,CAAC;EACnE,GAAG,EAAE,CAAC,OAAO,EAAE,UAAU,EAAC;EAC1B,CAAC;AACD;EACA,kBAAkB,CAAC,MAAM;;;;;;"}